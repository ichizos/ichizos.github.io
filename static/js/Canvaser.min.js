/* Canvaser.min.js by igor.cukovic
* 
* dependencies:
* - w3color.js ver.1.18 by w3schools.com (Do not remove this line)
*/
(function(){function w(a,b){if(!(this instanceof w))return new w(a,b);if("object"==typeof a)return a;this.attachValues(x(a));b&&(b.style.backgroundColor=this.toRgbString())}function x(a){var b=[],c;a=a.toLowerCase().replace(/^\s+|\s+$/g,"");var m=a.substr(0,1).toUpperCase();var g=a.substr(1);var d=1;"R"!=m&&"Y"!=m&&"G"!=m&&"C"!=m&&"B"!=m&&"M"!=m&&"W"!=m||isNaN(g)||6==a.length&&-1==a.indexOf(",")||(a="ncol("+a+")");3==a.length||6==a.length||isNaN(a)||(a="ncol("+a+")");0<a.indexOf(",")&&-1==a.indexOf("(")&&
(a="ncol("+a+")");if("rgb"==a.substr(0,3)||"hsl"==a.substr(0,3)||"hwb"==a.substr(0,3)||"ncol"==a.substr(0,4)||"cmyk"==a.substr(0,4)){"ncol"==a.substr(0,4)?(4==a.split(",").length&&-1==a.indexOf("ncola")&&(a=a.replace("ncol","ncola")),g="ncol",a=a.substr(4)):"cmyk"==a.substr(0,4)?(g="cmyk",a=a.substr(4)):(g=a.substr(0,3),a=a.substr(3));var f=3;m=!1;"a"==a.substr(0,1).toLowerCase()?(f=4,m=!0,a=a.substr(1)):"cmyk"==g&&(f=4,5==a.split(",").length&&(f=5,m=!0));a=a.replace("(","");a=a.replace(")","");b=
a.split(",");if("rgb"==g){if(b.length!=f)return u();for(c=0;c<f;c++){if(""==b[c]||" "==b[c])b[c]="0";-1<b[c].indexOf("%")&&(b[c]=b[c].replace("%",""),b[c]=Number(b[c]/100),3>c&&(b[c]=Math.round(255*b[c])));if(isNaN(b[c]))return u();255<parseInt(b[c])&&(b[c]=255);3>c&&(b[c]=parseInt(b[c]));3==c&&1<Number(b[c])&&(b[c]=1)}var h={r:b[0],g:b[1],b:b[2]};1==m&&(d=Number(b[3]))}if("hsl"==g||"hwb"==g||"ncol"==g){for(;b.length<f;)b.push("0");("hsl"==g||"hwb"==g)&&360<=parseInt(b[0])&&(b[0]=0);for(c=1;c<f;c++){if(-1<
b[c].indexOf("%")){b[c]=b[c].replace("%","");b[c]=Number(b[c]);if(isNaN(b[c]))return u();b[c]/=100}else b[c]=Number(b[c]);1<Number(b[c])&&(b[c]=1);0>Number(b[c])&&(b[c]=0)}if("hsl"==g){h=q(b[0],b[1],b[2]);var y=Number(b[0]);var n=Number(b[1])}"hwb"==g&&(h=e(b[0],b[1],b[2]));if("ncol"==g)a:{var l=b[0];a=b[1];h=b[2];var r=l;if(isNaN(l.substr(0,1))){c=l.substr(0,1).toUpperCase();l=l.substr(1);""==l&&(l=0);l=Number(l);if(isNaN(l)){h=!1;break a}"R"==c&&(r=.6*l);"Y"==c&&(r=60+.6*l);"G"==c&&(r=120+.6*l);
"C"==c&&(r=180+.6*l);"B"==c&&(r=240+.6*l);"M"==c&&(r=300+.6*l);"W"==c&&(r=0,a=1-l/100,h=l/100)}h=e(r,a,h)}1==m&&(d=Number(b[3]))}if("cmyk"==g){for(;b.length<f;)b.push("0");for(c=0;c<f;c++){if(-1<b[c].indexOf("%")){b[c]=b[c].replace("%","");b[c]=Number(b[c]);if(isNaN(b[c]))return u();b[c]/=100}else b[c]=Number(b[c]);1<Number(b[c])&&(b[c]=1);0>Number(b[c])&&(b[c]=0)}g=b[3];h={r:255-255*Math.min(1,b[0]*(1-g)+g),g:255-255*Math.min(1,b[1]*(1-g)+g),b:255-255*Math.min(1,b[2]*(1-g)+g)};1==m&&(d=Number(b[4]))}}else if("ncs"==
a.substr(0,3))h=k(a);else{m=!1;g=v("names");for(c=0;c<g.length;c++)if(a.toLowerCase()==g[c].toLowerCase()){g=v("hexs");m=!0;h={r:parseInt(g[c].substr(0,2),16),g:parseInt(g[c].substr(2,2),16),b:parseInt(g[c].substr(4,2),16)};break}if(0==m){a=a.replace("#","");3==a.length&&(a=a.substr(0,1)+a.substr(0,1)+a.substr(1,1)+a.substr(1,1)+a.substr(2,1)+a.substr(2,1));for(c=0;c<a.length;c++)if(!(-1<"0123456789ABCDEFabcdef".indexOf(a.substr(c,1))))return u();b[0]=parseInt(a.substr(0,2),16);b[1]=parseInt(a.substr(2,
2),16);b[2]=parseInt(a.substr(4,2),16);for(c=0;3>c;c++)if(isNaN(b[c]))return u();h={r:b[0],g:b[1],b:b[2]}}}return t(h,d,y,n)}function t(a,b,c,m){var g,e;if(!a)return u();b||(b=1);var f=a.g,d=a.b,k;var n=[];n[0]=a.r/255;n[1]=f/255;n[2]=d/255;f=n[0];d=n[0];for(k=g=0;k<n.length-1;k++)n[k+1]<=f&&(f=n[k+1]),n[k+1]>=d&&(d=n[k+1],g=k+1);0==g&&(e=(n[1]-n[2])/(d-f));1==g&&(e=2+(n[2]-n[0])/(d-f));2==g&&(e=4+(n[0]-n[1])/(d-f));isNaN(e)&&(e=0);e*=60;0>e&&(e+=360);n=(f+d)/2;k=a.r;var l=a.g;var r=a.b;k/=255;l/=
255;r/=255;g=Math.max(k,l,r);k=Math.min(k,l,r);g=1-g;var p=a.r;var q=a.g;r=a.b;p/=255;q/=255;r/=255;l=1-Math.max(p,q,r);if(1==l)var t=q=p=0;else p=(1-p-l)/(1-l),q=(1-q-l)/(1-l),t=(1-r-l)/(1-l);r=p;p=q;q=t;c=c||e;e=m||(f==d?0:.5>n?(d-f)/(d+f):(d-f)/(2-d-f));m=h(c);a={red:a.r,green:a.g,blue:a.b,hue:c,sat:e,lightness:n,whiteness:k,blackness:g,cyan:r,magenta:p,yellow:q,black:l,ncol:m,opacity:b,valid:!0};a.red=Number(a.red.toFixed(0));a.green=Number(a.green.toFixed(0));a.blue=Number(a.blue.toFixed(0));
a.hue=Number(a.hue.toFixed(0));a.sat=Number(a.sat.toFixed(2));a.lightness=Number(a.lightness.toFixed(2));a.whiteness=Number(a.whiteness.toFixed(2));a.blackness=Number(a.blackness.toFixed(2));a.cyan=Number(a.cyan.toFixed(2));a.magenta=Number(a.magenta.toFixed(2));a.yellow=Number(a.yellow.toFixed(2));a.black=Number(a.black.toFixed(2));a.ncol=a.ncol.substr(0,1)+Math.round(Number(a.ncol.substr(1)));a.opacity=Number(a.opacity.toFixed(2));return a}function u(){return{red:0,green:0,blue:0,hue:0,sat:0,lightness:0,
whiteness:0,blackness:0,cyan:0,magenta:0,yellow:0,black:0,ncol:"R",opacity:1,valid:!1}}function v(a){if("names"==a)return"AliceBlue AntiqueWhite Aqua Aquamarine Azure Beige Bisque Black BlanchedAlmond Blue BlueViolet Brown BurlyWood CadetBlue Chartreuse Chocolate Coral CornflowerBlue Cornsilk Crimson Cyan DarkBlue DarkCyan DarkGoldenRod DarkGray DarkGrey DarkGreen DarkKhaki DarkMagenta DarkOliveGreen DarkOrange DarkOrchid DarkRed DarkSalmon DarkSeaGreen DarkSlateBlue DarkSlateGray DarkSlateGrey DarkTurquoise DarkViolet DeepPink DeepSkyBlue DimGray DimGrey DodgerBlue FireBrick FloralWhite ForestGreen Fuchsia Gainsboro GhostWhite Gold GoldenRod Gray Grey Green GreenYellow HoneyDew HotPink IndianRed Indigo Ivory Khaki Lavender LavenderBlush LawnGreen LemonChiffon LightBlue LightCoral LightCyan LightGoldenRodYellow LightGray LightGrey LightGreen LightPink LightSalmon LightSeaGreen LightSkyBlue LightSlateGray LightSlateGrey LightSteelBlue LightYellow Lime LimeGreen Linen Magenta Maroon MediumAquaMarine MediumBlue MediumOrchid MediumPurple MediumSeaGreen MediumSlateBlue MediumSpringGreen MediumTurquoise MediumVioletRed MidnightBlue MintCream MistyRose Moccasin NavajoWhite Navy OldLace Olive OliveDrab Orange OrangeRed Orchid PaleGoldenRod PaleGreen PaleTurquoise PaleVioletRed PapayaWhip PeachPuff Peru Pink Plum PowderBlue Purple RebeccaPurple Red RosyBrown RoyalBlue SaddleBrown Salmon SandyBrown SeaGreen SeaShell Sienna Silver SkyBlue SlateBlue SlateGray SlateGrey Snow SpringGreen SteelBlue Tan Teal Thistle Tomato Turquoise Violet Wheat White WhiteSmoke Yellow YellowGreen".split(" ");
if("hexs"==a)return"f0f8ff faebd7 00ffff 7fffd4 f0ffff f5f5dc ffe4c4 000000 ffebcd 0000ff 8a2be2 a52a2a deb887 5f9ea0 7fff00 d2691e ff7f50 6495ed fff8dc dc143c 00ffff 00008b 008b8b b8860b a9a9a9 a9a9a9 006400 bdb76b 8b008b 556b2f ff8c00 9932cc 8b0000 e9967a 8fbc8f 483d8b 2f4f4f 2f4f4f 00ced1 9400d3 ff1493 00bfff 696969 696969 1e90ff b22222 fffaf0 228b22 ff00ff dcdcdc f8f8ff ffd700 daa520 808080 808080 008000 adff2f f0fff0 ff69b4 cd5c5c 4b0082 fffff0 f0e68c e6e6fa fff0f5 7cfc00 fffacd add8e6 f08080 e0ffff fafad2 d3d3d3 d3d3d3 90ee90 ffb6c1 ffa07a 20b2aa 87cefa 778899 778899 b0c4de ffffe0 00ff00 32cd32 faf0e6 ff00ff 800000 66cdaa 0000cd ba55d3 9370db 3cb371 7b68ee 00fa9a 48d1cc c71585 191970 f5fffa ffe4e1 ffe4b5 ffdead 000080 fdf5e6 808000 6b8e23 ffa500 ff4500 da70d6 eee8aa 98fb98 afeeee db7093 ffefd5 ffdab9 cd853f ffc0cb dda0dd b0e0e6 800080 663399 ff0000 bc8f8f 4169e1 8b4513 fa8072 f4a460 2e8b57 fff5ee a0522d c0c0c0 87ceeb 6a5acd 708090 708090 fffafa 00ff7f 4682b4 d2b48c 008080 d8bfd8 ff6347 40e0d0 ee82ee f5deb3 ffffff f5f5f5 ffff00 9acd32".split(" ")}
function q(a,b,c){a/=60;b=.5>=c?c*(b+1):c+b-c*b;var m=2*c-b;c=255*d(m,b,a+2);var g=255*d(m,b,a);a=255*d(m,b,a-2);return{r:c,g:g,b:a}}function d(a,b,c){0>c&&(c+=6);6<=c&&(c-=6);return 1>c?(b-a)*c+a:3>c?b:4>c?(b-a)*(4-c)+a:a}function e(a,b,c){var d=[];a=q(a,1,.5);d[0]=a.r/255;d[1]=a.g/255;d[2]=a.b/255;a=b+c;1<a&&(b=Number((b/a).toFixed(2)),c=Number((c/a).toFixed(2)));for(a=0;3>a;a++)d[a]*=1-b-c,d[a]+=b,d[a]=Number(255*d[a]);return{r:d[0],g:d[1],b:d[2]}}function h(a){for(;360<=a;)a-=360;if(60>a)return"R"+
a/.6;if(120>a)return"Y"+(a-60)/.6;if(180>a)return"G"+(a-120)/.6;if(240>a)return"C"+(a-180)/.6;if(300>a)return"B"+(a-240)/.6;if(360>a)return"M"+(a-300)/.6}function k(a){var b,c,d;a=a.replace(/^\s+|\s+$/g,"").toUpperCase();a=a.replace("(","");a=a.replace(")","");a=a.replace("NCS","NCS ");a=a.replace(/  /g," ");-1==a.indexOf("NCS")&&(a="NCS "+a);a=a.match(/^(?:NCS|NCS\sS)\s(\d{2})(\d{2})-(N|[A-Z])(\d{2})?([A-Z])?$/);if(null===a)return!1;var g=parseInt(a[1],10);var e=parseInt(a[2],10);var f=a[3];if("N"!=
f&&"Y"!=f&&"R"!=f&&"B"!=f&&"G"!=f)return!1;a=parseInt(a[4],10)||0;"N"!==f?(g=1.05*g-5.25,"Y"===f&&60>=a?c=1:"Y"===f&&60<a||"R"===f&&80>=a?c=(Math.sqrt(14884-Math.pow("Y"===f?a-60:a+40,2))-22)/100:"R"===f&&80<a||"B"===f?c=0:"G"===f&&(c=(Math.sqrt(33800-Math.pow(a-170,2))-70)/100),"Y"===f&&80>=a?b=0:"Y"===f&&80<a||"R"===f&&60>=a?b=(104-Math.sqrt(11236-Math.pow("Y"===f?a-80+20.5:a+20+20.5,2)))/100:"R"===f&&60<a||"B"===f&&80>=a?b=(Math.sqrt(1E4-Math.pow("R"===f?a-60-60:a+40-60,2))-10)/100:"B"===f&&80<
a||"G"===f&&40>=a?b=(122-Math.sqrt(19881-Math.pow("B"===f?a-80-131:a+20-131,2)))/100:"G"===f&&40<a&&(b=0),"Y"===f?d=(85-.85*a)/100:"R"===f&&60>=a?d=0:"R"===f&&60<a?d=(67.5-Math.sqrt(5776-Math.pow(a-60+35,2)))/100:"B"===f&&60>=a?d=(6.5+Math.sqrt(7044.5-Math.pow(1*a-68.5,2)))/100:"B"===f&&60<a||"G"===f&&60>=a?d=.9:"G"===f&&60<a&&(d=(90-.125*(a-60))/100),f=(c+d+b)/3,c=(f-c)*(100-e)/100+c,d=(f-d)*(100-e)/100+d,b=(f-b)*(100-e)/100+b,f=1/(c>d&&c>b?c:d>c&&d>b?d:b>c&&b>d?b:(c+d+b)/3),e=parseInt(c*f*(100-
g)/100*255,10),d=parseInt(d*f*(100-g)/100*255,10),g=parseInt(b*f*(100-g)/100*255,10),255<e&&(e=255),255<d&&(d=255),255<g&&(g=255),0>e&&(e=0),0>d&&(d=0),0>g&&(g=0)):(g=parseInt(255*(1-g/100),10),255<g&&(g=255),0>g&&(g=0),d=e=g);return{r:e,g:d,b:g}}function p(a){for(a=a.toString(16);2>a.length;)a="0"+a;return a}w.prototype={toRgbString:function(){return"rgb("+this.red+", "+this.green+", "+this.blue+")"},toRgbaString:function(){return"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.opacity+
")"},toHwbString:function(){return"hwb("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%)"},toHwbStringDecimal:function(){return"hwb("+this.hue+", "+this.whiteness+", "+this.blackness+")"},toHwbaString:function(){return"hwba("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity+")"},toHslString:function(){return"hsl("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%)"},toHslStringDecimal:function(){return"hsl("+
this.hue+", "+this.sat+", "+this.lightness+")"},toHslaString:function(){return"hsla("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%, "+this.opacity+")"},toCmykString:function(){return"cmyk("+Math.round(100*this.cyan)+"%, "+Math.round(100*this.magenta)+"%, "+Math.round(100*this.yellow)+"%, "+Math.round(100*this.black)+"%)"},toCmykStringDecimal:function(){return"cmyk("+this.cyan+", "+this.magenta+", "+this.yellow+", "+this.black+")"},toNcolString:function(){return this.ncol+
", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%"},toNcolStringDecimal:function(){return this.ncol+", "+this.whiteness+", "+this.blackness},toNcolaString:function(){return this.ncol+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity},toName:function(){for(var a,b,c,d=v("hexs"),e=0;e<d.length;e++)if(a=parseInt(d[e].substr(0,2),16),b=parseInt(d[e].substr(2,2),16),c=parseInt(d[e].substr(4,2),16),this.red==a&&this.green==b&&this.blue==
c)return v("names")[e];return""},toHexString:function(){var a=p(this.red),b=p(this.green),c=p(this.blue);return"#"+a+b+c},toRgb:function(){return{r:this.red,g:this.green,b:this.blue,a:this.opacity}},toHsl:function(){return{h:this.hue,s:this.sat,l:this.lightness,a:this.opacity}},toHwb:function(){return{h:this.hue,w:this.whiteness,b:this.blackness,a:this.opacity}},toCmyk:function(){return{c:this.cyan,m:this.magenta,y:this.yellow,k:this.black,a:this.opacity}},toNcol:function(){return{ncol:this.ncol,
w:this.whiteness,b:this.blackness,a:this.opacity}},isDark:function(a){return(299*this.red+587*this.green+114*this.blue)/1E3<(a||128)},saturate:function(a){this.sat+=a/100||.1;1<this.sat&&(this.sat=1);a=q(this.hue,this.sat,this.lightness);a=t(a,this.opacity,this.hue,this.sat);this.attachValues(a)},desaturate:function(a){this.sat-=a/100||.1;0>this.sat&&(this.sat=0);a=q(this.hue,this.sat,this.lightness);a=t(a,this.opacity,this.hue,this.sat);this.attachValues(a)},lighter:function(a){this.lightness+=a/
100||.1;1<this.lightness&&(this.lightness=1);a=q(this.hue,this.sat,this.lightness);a=t(a,this.opacity,this.hue,this.sat);this.attachValues(a)},darker:function(a){this.lightness-=a/100||.1;0>this.lightness&&(this.lightness=0);a=q(this.hue,this.sat,this.lightness);a=t(a,this.opacity,this.hue,this.sat);this.attachValues(a)},attachValues:function(a){this.red=a.red;this.green=a.green;this.blue=a.blue;this.hue=a.hue;this.sat=a.sat;this.lightness=a.lightness;this.whiteness=a.whiteness;this.blackness=a.blackness;
this.cyan=a.cyan;this.magenta=a.magenta;this.yellow=a.yellow;this.black=a.black;this.ncol=a.ncol;this.opacity=a.opacity;this.valid=a.valid}};window.w3color=w})();(function(){function w(d){for(var e=[],h=0,k;h<d.length;h++)k=d[h],e.push(new v(k.backgroundColor,k.imageSrc,k.imageColor));return e}function x(d){return d.layers.reduce(function(d,h){return h.imageSrc?++d:d},0)}function t(d,e){for(var h=0,k=d.countLayers();h<k;h++)e(d,d.getLayer(h))}function u(d,e){e.imageSrc?(e.image=new Image,e.image.src=e.imageSrc,e.image.addEventListener("load",function(){d.loadedImages++;d.render()}),e.image.addEventListener("error",function(){d.loadedImages++;d.render()})):
d.render()}var v=function(d,e,h){this._backgroundColor=d?new w3color(d):void 0;this._imageSrc=e;this._imageColor=h?new w3color(h):void 0};v.prototype={set backgroundColor(d){this._backgroundColor=new w3color(d)},get backgroundColor(){return this._backgroundColor},set imageSrc(d){this._imageSrc=d},get imageSrc(){return this._imageSrc},set imageColor(d){this._imageColor=new w3color(d)},get imageColor(){return this._imageColor}};var q=function(d,e){var h=this;h.container=document.getElementById(d);h.layers=
w(e);h.canvas=document.createElement("canvas");h.ctx=h.canvas.getContext("2d");h.loadedImages=0;h.imagesToLoad=x(h);t(h,u);window.addEventListener("resize",function(){h.rerender()})};q.prototype={render:function(){this.loadedImages==this.imagesToLoad&&(this.canvas.width=this.container.clientWidth,this.canvas.height=this.container.clientWidth,t(this,function(d,e){e.canvas=document.createElement("canvas");e.canvas.width=d.canvas.width;e.canvas.height=d.canvas.height;e.ctx=e.canvas.getContext("2d");
e.backgroundColor&&(e.ctx.fillStyle=e.backgroundColor.toHexString(),e.ctx.fillRect(0,0,e.canvas.width,e.canvas.height));if(e.image){var h=e.canvas.width,k=Math.round(h/(e.image.width/e.image.height));e.ctx.drawImage(e.image,0,Math.round((e.canvas.height-k)/2),h,k)}if(e.imageColor){h=e.ctx.getImageData(0,0,e.canvas.width,e.canvas.height);k=h.data;for(var p=0;p<k.length;p+=4)0<k[p+3]&&(k[p]=e.imageColor.red,k[p+1]=e.imageColor.green,k[p+2]=e.imageColor.blue);e.ctx.putImageData(h,0,0)}h=d.canvas.width;
k=d.canvas.height;d.ctx.drawImage(e.canvas,0,0,h,k)}),this.container.innerHTML="",this.container.appendChild(this.canvas))},rerender:function(){this.clearCanvas();this.render()},clearCanvas:function(d){d&&(this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0));this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);d&&this.ctx.restore()},getLayer:function(d){return this.layers[d]},getLayerImageColor:function(d){return this.getLayer(d).imageColor.toHexString()},setLayerImageColor:function(d,e){this.getLayer(d).imageColor=
e;this.rerender()},getLayerBackgroundColor:function(d){return this.getLayer(d).backgroundColor.toHexString()},setLayerBackgroundColor:function(d,e){this.getLayer(d).backgroundColor=e;this.rerender()},countLayers:function(){return this.layers.length}};window.Canvaser=q})();
